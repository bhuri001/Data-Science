-- 1. Count of unique orders completed on March 18, 2023
SELECT COUNT(DISTINCT Order_id) AS total_orders  
FROM SALES  
WHERE Date = '2023-03-18';  

-- 2. Count of unique orders on March 18, 2023, placed by a customer named 'John Doe'
SELECT COUNT(DISTINCT S.Order_id) AS total_orders  
FROM SALES S  
JOIN CUSTOMERS C ON S.Customer_id = C.Customer_id  
WHERE S.Date = '2023-03-18' AND C.First_name = 'John' AND C.Last_name = 'Doe';  

-- 3. Number of unique customers who made purchases in January 2023 and their average spending  
SELECT COUNT(DISTINCT Customer_id) AS total_customers,  
       AVG(Revenue) AS avg_spent_per_customer  
FROM SALES  
WHERE Date BETWEEN '2023-01-01' AND '2023-01-31';  

-- 4. Departments that generated total revenue below $600 in 2022  
SELECT I.Department, SUM(S.Revenue) AS total_revenue  
FROM SALES S  
JOIN ITEMS I ON S.Item_id = I.Item_id  
WHERE YEAR(S.Date) = 2022  
GROUP BY I.Department  
HAVING SUM(S.Revenue) < 600;  

-- 5. Retrieve the highest and lowest revenue generated by a single order  
SELECT MAX(Revenue) AS max_revenue, MIN(Revenue) AS min_revenue  
FROM SALES;  

-- 6. Retrieve details of the order(s) with the highest revenue  
SELECT * FROM SALES  
WHERE Revenue = (SELECT MAX(Revenue) FROM SALES);  
